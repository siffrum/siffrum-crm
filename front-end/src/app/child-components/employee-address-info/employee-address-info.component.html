<div class="container-fluid">
    <div class="row py-lg-2">
        <div class="col-lg-12 col-md-12 col-sm-12 col-12">
            <button class="btn coinButton mb-2" (click)="openEmployeeAddressInfoModal(0)"
                *ngIf="viewModel.Permission?.add"> Add New Address &#43; </button>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-12  text-end"><label>Total Count:
                <span>{{viewModel.pagination.totalCount}}</span></label> </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-12 tableFixHead">

            <table class="table mb-0">

                <thead>
                    <tr>
                        <th> Employee </th>
                        <th> Country </th>
                        <th> State </th>
                        <th> City </th>
                        <th> Pincode </th>
                        <th> Address 1 </th>
                        <th> Address 2 </th>
                        <th>Address Type</th>
                        <th *ngIf="viewModel.Permission?.edit || viewModel.Permission?.delete">Actions</th>
                    </tr>
                </thead>

                <tbody>
                    <tr *ngFor="let item of viewModel.employeeAddressList">
                        <td> {{employee.loginId}} </td>
                        <td> {{item.country}} </td>
                        <td> {{item.state}} </td>
                        <td> {{item.city}} </td>
                        <td> {{item.pinCode}} </td>
                        <td> {{item.address1}} </td>
                        <td> {{item.address2}} </td>
                        <td> {{item.clientUserAddressType}} </td>
                        <td *ngIf="viewModel.Permission?.edit ||viewModel.Permission?.delete">
                            <i class="bi bi-pencil-square smallIcon ms-0"
                                (click)="openEmployeeAddressInfoModal( item.id)"
                                (mouseenter)="viewModel.showTooltip = true" (mouseleave)="viewModel.showTooltip = false"
                                [attr.title]="'Edit'" [attr.data-placement]="'left'"
                                [ngClass]="{ 'tooltip-show': viewModel.showTooltip }"
                                *ngIf="viewModel.Permission?.edit">
                            </i>
                            <i class="bi bi-trash smallIcon" (click)="deleteEmployeeAddressByAddressId(item.id)"
                                (mouseenter)="viewModel.showTooltip = true" (mouseleave)="viewModel.showTooltip = false"
                                [attr.title]="'Delete'" [attr.data-placement]="'left'"
                                [ngClass]="{ 'tooltip-show': viewModel.showTooltip }"
                                *ngIf="viewModel.Permission?.delete"></i>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-12 d-flex justify-content-center pt-1"
            *ngIf="viewModel.pagination && viewModel.pagination.totalCount>0">
            <pagination (selectedPageNum)="loadPagedataWithPagination($event)" [viewModel]="viewModel.pagination">
            </pagination>
        </div>
    </div>
</div>
<div class="modal expandIn" tabindex="-1" role="dialog" [ngStyle]="{'display':viewModel.displayStyle}">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <div class="col-lg-11 col-md-11 col-sm-11 col-11" *ngIf="isaddmode">
                    <h5> Add Employee Address </h5>
                </div>

                <div class="col-lg-11 col-md-11 col-sm-11 col-11" *ngIf="isEditMode && !viewModel.editMode">
                    <h5> Add Employee Address </h5>
                </div>

                <div class="col-lg-11 col-md-11 col-sm-11 col-11" *ngIf="isEditMode && viewModel.editMode">
                    <h5> Edit Employee Address </h5>
                </div>

                <button type="button" class="btn-close" (click)="closePopup(addressForm)"></button>
            </div>
            <form #addressForm="ngForm">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-4 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> Country <span class="text-danger fs-5">*</span> </label>
                        </div>

                        <div class="col-lg-8 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" required name="country"
                                [(ngModel)]="viewModel.employeeAddress.country" pattern="^[A-Za-z][A-Za-z0-9\s]*$"
                                placeholder="Country" #country="ngModel" minlength="3" maxlength="20">
                            <ng-container *ngFor="let validation of viewModel.validations.country">
                                <div class="text-danger validationMsg"
                                    *ngIf="(country.touched || viewModel.formSubmitted) && country.hasError(validation.type)">
                                    {{ validation.message }}
                                </div>
                            </ng-container>
                        </div>

                        <div class="col-lg-4 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> State <span class="text-danger fs-5">*</span> </label>
                        </div>

                        <div class="col-lg-8 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" required name="state"
                                [(ngModel)]="viewModel.employeeAddress.state" pattern="^[A-Za-z][A-Za-z0-9\s]*$"
                                placeholder="State" #state="ngModel" minlength="2" maxlength="20">
                            <ng-container *ngFor="let validation of viewModel.validations.state">
                                <div *ngIf="(state.touched || viewModel.formSubmitted) && state.hasError(validation.type)"
                                    class="text-danger validationMsg">
                                    {{validation.message}}
                                </div>
                            </ng-container>
                        </div>

                        <div class="col-lg-4 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> City <span class="text-danger fs-5">*</span> </label>
                        </div>

                        <div class="col-lg-8 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" required name="city"
                                [(ngModel)]="viewModel.employeeAddress.city" placeholder="City" #city="ngModel"
                                pattern="^[A-Za-z][A-Za-z0-9\s]*$" minlength="3" maxlength="30">
                            <div *ngFor="let validation of viewModel.validations.city">
                                <div *ngIf="(city.touched || viewModel.formSubmitted) && city.hasError(validation.type)"
                                    class="text-danger validationMsg">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> Pincode <span class="text-danger fs-5">*</span> </label>
                        </div>

                        <div class="col-lg-8 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" required name="pinCode"
                                [(ngModel)]="viewModel.employeeAddress.pinCode" placeholder="Pin Code"
                                #pincode="ngModel" pattern="^\d{6}$" minlength="3" maxlength="20">
                            <div *ngFor="let validation of viewModel.validations.pincode">
                                <div *ngIf="(pincode.touched || viewModel.formSubmitted) && pincode.hasError(validation.type)"
                                    class="text-danger validationMsg">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> Address One <span class="text-danger fs-5">*</span> </label>
                        </div>

                        <div class="col-lg-8 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" required name="address1"
                                [(ngModel)]="viewModel.employeeAddress.address1" placeholder="Permenant Address"
                                #address1="ngModel" pattern="^[A-Za-z][A-Za-z0-9\s]*$" minlength="3" maxlength="50">
                            <div *ngFor="let validation of viewModel.validations.address1">
                                <div *ngIf="(address1.touched || viewModel.formSubmitted) && address1.hasError(validation.type)"
                                    class="text-danger validationMsg">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> Address Two </label>
                        </div>

                        <div class="col-lg-8 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" [(ngModel)]="viewModel.employeeAddress.address2"
                                name="address2" placeholder="Temporary Address" #address2="ngModel"
                                pattern="^[A-Za-z][A-Za-z0-9\s]*$" minlength="3" maxlength="50">
                            <div *ngFor="let validation of viewModel.validations.address2">
                                <div *ngIf="(address2.touched || viewModel.formSubmitted) && address2.hasError(validation.type)"
                                    class="text-danger validationMsg">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-end"
                        *ngIf="isaddmode &&viewModel.Permission?.add">
                        <button class="btn coinButton" (click)="addEmployeeAddressInfo(addressForm)"> Save & Next
                        </button>
                        <a class="skipLink d-block" (click)="skipEmployeeFurther()"> Skip for Now </a>
                    </div>

                    <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-end"
                        *ngIf="isEditMode && !viewModel.editMode &&viewModel.Permission?.add">
                        <button class="btn coinButton" (click)="addEmployeeAddressInfo(addressForm)"
                            *ngIf="viewModel.Permission?.add"> Save </button>
                    </div>

                    <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-end"
                        *ngIf="isEditMode && viewModel.editMode &&viewModel.Permission?.edit">
                        <button class="btn coinButton" (click)="updateEmployeeAddressInfo(addressForm)"> Update Details
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>