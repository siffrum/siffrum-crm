<div class="container-fluid">
    <div class="row py-lg-2">
        <div class="col-lg-12 col-md-12 col-sm-12 col-12">
            <button class="btn coinButton" (click)="openEmployeeBankModal(0)" *ngIf="viewModel.Permission?.add"> Add New
                Bank Info &#43; </button>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-12  text-end"><label>Total Count:
                <span>{{viewModel.pagination.totalCount}}</span></label> </div>

        <div class="col-lg-12 col-md-12 col-sm-12 col-12 tableFixHead">

            <table class="table mb-0">

                <thead>
                    <tr>
                        <th> Employee Name </th>
                        <th> Bank Name </th>
                        <th> Branch </th>
                        <th> Account Number </th>
                        <th>IFSC Code</th>
                        <th *ngIf="viewModel.Permission?.edit || viewModel.Permission?.delete">Actions</th>
                    </tr>
                </thead>

                <tbody>
                    <tr *ngFor="let item of viewModel.employeeBankList ">
                        <td> {{employee.loginId}} </td>
                        <td> {{item.bankName}} </td>
                        <td> {{item.branch}} </td>
                        <td> {{item.accountNo}} </td>
                        <td> {{item.ifscCode}} </td>
                        <td *ngIf="viewModel.Permission?.edit || viewModel.Permission?.delete">
                            <i class="bi bi-pencil-square smallIcon ms-0" (click)="openEmployeeBankModal( item.id)"
                                (mouseenter)="viewModel.showTooltip = true" (mouseleave)="viewModel.showTooltip = false"
                                [attr.title]="'Edit'" [attr.data-placement]="'left'"
                                [ngClass]="{ 'tooltip-show': viewModel.showTooltip }"
                                *ngIf="viewModel.Permission?.edit">
                            </i>
                            <i class=" bi bi-trash smallIcon" (click)="deleteEmployeeBankByBankId(item.id)"
                                (mouseenter)="viewModel.showTooltip = true" (mouseleave)="viewModel.showTooltip = false"
                                [attr.title]="'Delete'" [attr.data-placement]="'left'"
                                [ngClass]="{ 'tooltip-show': viewModel.showTooltip }"
                                *ngIf="viewModel.Permission?.delete"></i>
                        </td>
                    </tr>

                </tbody>

            </table>

        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-12 d-flex justify-content-center pt-1"
            *ngIf="viewModel.pagination && viewModel.pagination.totalCount>0">
            <pagination (selectedPageNum)="loadPagedataWithPagination($event)" [viewModel]="viewModel.pagination">
            </pagination>
        </div>

    </div>

    <!-- <div class="row">

    </div> -->
</div>
<div class="modal expandIn" tabindex="-1" role="dialog" [ngStyle]="{'display':viewModel.displayStyle}">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <div class="col-lg-11 col-md-11 col-sm-11 col-11" *ngIf="isaddmode">
                    <h5> Add Employee Bank Details </h5>
                </div>

                <div class="col-lg-11 col-md-11 col-sm-11 col-11" *ngIf="isEditMode && !viewModel.editMode">
                    <h5> Add Employee Bank Details </h5>
                </div>

                <div class="col-lg-11 col-md-11 col-sm-11 col-11" *ngIf="isEditMode && viewModel.editMode">
                    <h5> Edit Employee Bank Details </h5>
                </div>

                <button type="button" class="btn-close" (click)="closePopup(bankDetailForm)"></button>
            </div>
            <form #bankDetailForm="ngForm">
                <div class="modal-body">
                    <div class="row">

                        <div class="col-lg-5 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> Bank Name <span class="text-danger fs-5">*</span> </label>
                        </div>

                        <div class="col-lg-7 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" required name="bankName"
                                pattern="^[A-Za-z][A-Za-z0-9\s]*$" [(ngModel)]="viewModel.employeeBank.bankName"
                                minlength="3" maxlength="30" placeholder="Enter Bank Name" #bankName="ngModel">
                            <div *ngFor="let validation of viewModel.validations.bankName">
                                <div *ngIf="(bankName.touched || viewModel.formSubmitted) && bankName.hasError(validation.type)"
                                    class="text-danger validationMsg">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-5 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> Branch Name <span class="text-danger fs-5">*</span> </label>
                        </div>

                        <div class="col-lg-7 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" required name="branchName"
                                pattern="^[A-Za-z][A-Za-z0-9\s]*$" [(ngModel)]="viewModel.employeeBank.branch"
                                minlength="3" maxlength="20" placeholder="Enter Branch name" #branchName="ngModel">
                            <div *ngFor="let validation of viewModel.validations.branchName">
                                <div *ngIf="(branchName.touched || viewModel.formSubmitted) && branchName.hasError(validation.type)"
                                    class="text-danger validationMsg">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-5 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> Account Number <span class="text-danger fs-5">*</span> </label>
                        </div>

                        <div class="col-lg-7 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" required name="accountNo" pattern="^[0-9]{1,20}$"
                                [(ngModel)]="viewModel.employeeBank.accountNo" minlength="5" maxlength="20"
                                placeholder="Enter Account Number" #accountNo="ngModel" pattern="^[0-9]{3,10}$">
                            <div *ngFor="let validation of viewModel.validations.accountNo">
                                <div *ngIf="(accountNo.touched || viewModel.formSubmitted) && accountNo.hasError(validation.type)"
                                    class="text-danger validationMsg">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-5 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <label> Ifsc Code <span class="text-danger fs-5">*</span> </label>
                        </div>

                        <div class="col-lg-7 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
                            <input type="text" class="form-control" required name="ifscCode" pattern="^[A-Za-z0-9]+$"
                                [(ngModel)]="viewModel.employeeBank.ifscCode" minlength="5" maxlength="11"
                                placeholder="Enter IFSC Code" #ifscCode="ngModel">
                            <div *ngFor="let validation of viewModel.validations.ifscCode">
                                <div *ngIf="(ifscCode.touched || viewModel.formSubmitted) && ifscCode.hasError(validation.type)"
                                    class="text-danger validationMsg">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">

                    <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-end"
                        *ngIf="isaddmode &&viewModel.Permission?.add">
                        <button class="btn coinButton" (click)="addEmployeeBankInfo(bankDetailForm)"> Save & Next
                        </button>
                        <a class="skipLink d-block" (click)="skipEmployeeFurther()"> Skip for Now </a>
                    </div>

                    <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-end"
                        *ngIf="isEditMode && !viewModel.editMode &&viewModel.Permission?.add">
                        <button class="btn coinButton" (click)="addEmployeeBankInfo(bankDetailForm)"> Save </button>
                    </div>

                    <div class="col-lg-12 col-md-12 col-sm-12 col-12 text-end"
                        *ngIf="isEditMode && viewModel.editMode &&viewModel.Permission?.edit">
                        <button class="btn coinButton" (click)="updateEmployeeBankInfo(bankDetailForm)"> Update Details
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>