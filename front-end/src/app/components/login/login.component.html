<!-- login.component.html -->
<div class="auth" [ngClass]="{ 'dark': isDark }">
  <!-- Background -->
  <div class="bg">
    <div class="grad g1"></div>
    <div class="grad g2"></div>
    <div class="grid"></div>
    <div class="noise"></div>
  </div>

  <!-- Top controls -->
  <div class="top-actions">
    <button type="button" class="chip" (click)="goBack()" aria-label="Go back">
      <span class="chip-ic">‚Üê</span>
      <span>Back</span>
    </button>

    <button
      type="button"
      class="chip"
      (click)="toggleTheme()"
      [attr.aria-label]="isDark ? 'Switch to light mode' : 'Switch to dark mode'"
    >
      <span class="chip-ic">{{ isDark ? 'üåô' : '‚òÄÔ∏è' }}</span>
      <span>{{ isDark ? 'Dark' : 'Light' }}</span>
    </button>
  </div>

  <main class="wrap">
    <!-- Left / Brand -->
    <section class="side">
      <a class="brand" routerLink="/login" aria-label="Internal home">
        <span class="mark" aria-hidden="true"></span>
        <span class="name">Internal<span class="dot">.</span></span>
      </a>

      <h1 class="h1">
        Welcome back.<br />
        <span class="grad-text">Sign in to continue.</span>
      </h1>

      <p class="sub">
        Secure access to accounts, pipeline, and operations tools ‚Äî with role controls and audit-ready events.
      </p>

      <div class="mini">
        <div class="mini-card">
          <p class="k">Security</p>
          <p class="v">RBAC</p>
        </div>
        <div class="mini-card">
          <p class="k">Session</p>
          <p class="v">Token</p>
        </div>
        <div class="mini-card">
          <p class="k">UX</p>
          <p class="v">Fast</p>
        </div>
      </div>
    </section>

    <!-- Right / Form -->
    <section class="panel">
      <div class="card">
        <div class="card-head">
          <div>
            <h2 class="title">Sign in</h2>
            <p class="muted">Choose your role and enter your credentials.</p>
          </div>

          <div class="logo-wrap" aria-hidden="true">
            <img src="/assets/logo/l2.webp" alt="logo" class="logo" loading="lazy" />
          </div>
        </div>

        <div class="sep"></div>

        <!-- Company + Role -->
        <div class="two">
          <div class="block">
            <label class="label">Company Code</label>

            <div class="control" [ngClass]="{ 'invalid': Companycode.touched && Companycode.invalid }">
              <i class="bi bi-shield-lock-fill ic" aria-hidden="true"></i>
              <input
                type="text"
                class="input"
                autocomplete="off"
                placeholder="Company Code"
                required="required"
                [(ngModel)]="viewModel.tokenRequest.companyCode"
                name="Companycode"
                #Companycode="ngModel"
              />
            </div>

            <div *ngFor="let validation of viewModel.validations.Companycode">
              <div *ngIf="Companycode.touched && Companycode.hasError(validation.type)" class="err">
                {{ validation.message }}
              </div>
            </div>
          </div>

          <div class="block">
            <label class="label">Role</label>

            <select
              class="select"
              [ngClass]="{ 'invalid': SelectRole.touched && SelectRole.invalid }"
              autocomplete="off"
              required="required"
              [(ngModel)]="viewModel.tokenRequest.roleType"
              name="SelectRole"
              #SelectRole="ngModel"
            >
              <option value="undefined" disabled selected>Select Role</option>
              <option *ngFor="let item of viewModel.listRoles" [value]="item">{{ item }}</option>
            </select>

            <div *ngFor="let validation of viewModel.validations.SelectRole">
              <div *ngIf="SelectRole.touched && SelectRole.hasError(validation.type)" class="err">
                {{ validation.message }}
              </div>
            </div>
          </div>
        </div>

        <!-- Username -->
        <div class="block">
          <label class="label">Username</label>

          <div class="control" [ngClass]="{ 'invalid': username.touched && username.invalid }">
            <i class="bi bi-person-fill ic" aria-hidden="true"></i>
            <input
              type="text"
              class="input"
              autocomplete="off"
              placeholder="Enter your username"
              required="required"
              [(ngModel)]="viewModel.tokenRequest.loginId"
              name="username"
              #username="ngModel"
            />
          </div>

          <div *ngFor="let validation of viewModel.validations.username">
            <div *ngIf="username.touched && username.hasError(validation.type)" class="err">
              {{ validation.message }}
            </div>
          </div>
        </div>

        <!-- Password -->
        <div class="block">
          <div class="row">
            <label class="label">Password</label>
            <button type="button" class="link" (click)="togglePassword()">Show / Hide</button>
          </div>

          <div class="control" [ngClass]="{ 'invalid': password.touched && password.invalid }">
            <i class="bi bi-lock-fill ic" aria-hidden="true"></i>

            <input
              class="input pr"
              autocomplete="off"
              placeholder="Enter your password"
              required="required"
              [(ngModel)]="viewModel.tokenRequest.password"
              name="password"
              [type]="viewModel.hide ? 'password' : 'text'"
              #password="ngModel"
            />

            <button type="button" class="eye" (click)="togglePassword()" aria-label="Toggle password">
              <i class="bi bi-eye-fill"></i>
            </button>
          </div>

          <div *ngFor="let validation of viewModel.validations.password">
            <div *ngIf="password.touched && password.hasError(validation.type)" class="err">
              {{ validation.message }}
            </div>
          </div>
        </div>

        <!-- Remember + Forgot -->
        <div class="between">
          <label class="check">
            <input type="checkbox" name="rememberMe" [(ngModel)]="viewModel.rememberMe" />
            <span>Remember me</span>
          </label>

          <a routerLink="/forgotPassword" class="link">Forgot password?</a>
        </div>

        <!-- Submit -->
        <button
          type="submit"
          class="btn"
          [disabled]="Companycode.invalid || SelectRole.invalid || username.invalid || password.invalid"
          (click)="login()"
        >
          Continue
        </button>

        <div class="badges">
          <span class="badge"><span class="dot ok"></span> Audit ready</span>
          <span class="badge"><span class="dot blue"></span> RBAC</span>
        </div>

        <p class="foot">
          Don‚Äôt have an account?
          <a routerLink="/register" class="link strong">Sign up</a>
        </p>
      </div>
    </section>
  </main>
</div>
