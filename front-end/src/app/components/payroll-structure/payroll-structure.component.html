<div class="container-fluid">
  <div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-12 mb-lg-2">
      <button class="btn coinButton" (click)="openModal(0)" *ngIf="viewModel.Permission?.add"> Add Component &#43;
      </button>
    </div>
    <div class="col-lg-12 col-md-12 col-sm-12 col-12">
      <table class="table">
        <thead>
          <tr>
            <th class="firstTableHead"> Salary Component </th>
            <th>Description</th>
            <th> Percentage </th>
            <th>Calculation Type</th>
            <th>Period Type</th>
            <th *ngIf="viewModel.Permission?.delete || viewModel.Permission?.edit">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of viewModel.genericPayrolls">
            <td> {{data.name}} </td>
            <td> {{data.description}}</td>
            <td> {{data.percentage}}%</td>
            <td>{{data.componentCalculationType}}</td>
            <td> {{data.componentPeriodType}}</td>
            <td *ngIf="viewModel.Permission?.delete || viewModel.Permission?.edit">
              <i class="bi bi-pencil-square smallIcon ms-0" (click)="openModal(data.id)"
                *ngIf="viewModel.Permission?.edit" (mouseenter)="viewModel.showTooltip = true"
                (mouseleave)="viewModel.showTooltip = false" [attr.title]="'Edit'" [attr.data-placement]="'left'"
                [ngClass]="{ 'tooltip-show': viewModel.showTooltip }"></i>
              <i class="bi bi-trash smallIcon" (click)="deleteGenericPayrollComponent(data.id)"
                *ngIf="viewModel.Permission?.delete" (mouseenter)="viewModel.showTooltip = true"
                (mouseleave)="viewModel.showTooltip = false" [attr.title]="'Delete'" [attr.data-placement]="'left'"
                [ngClass]="{ 'tooltip-show': viewModel.showTooltip }"></i>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
<!-- Open Modal to Add Generic Payroll Component -->
<div class="modal expandIn" tabindex="-1" role="dialog" [ngStyle]="{'display':viewModel.displayStyle}">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <div class="col-lg-11 col-md-11 col-sm-11 col-11" *ngIf="viewModel.addMode">
          <h4>Add Generic Payroll Component</h4>
      </div>
      <div class="col-lg-11 col-md-11 col-sm-11 col-11" *ngIf="viewModel.editMode">
        <h4>Edit Generic Payroll Component</h4>
    </div>


        <button type="button" class="btn-close" aria-label="Close" (click)="closePopup(payrollForm)"></button>
      </div>
      <form #payrollForm="ngForm">
        <div class="modal-body">
          <div class="row">
            <div class="col-lg-5 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
              <label> Salary Type<span class="text-danger fs-5">*</span> </label>
            </div>
            <div class="col-lg-7 col-md-6 col-sm-12 col-12 ">
              <input type="text" class="form-control my-2" placeholder="Enter Salary Type"
                [(ngModel)]="viewModel.selectedGenericPayroll.name" minlength="2" maxlength="20" name="name"
                #name="ngModel" required pattern="^[A-Za-z][A-Za-z0-9\s]*$">
              <div *ngFor="let validation of viewModel.validations.name">
                <div *ngIf="(name.touched || viewModel.formSubmitted) && name.hasError(validation.type)"
                  class="text-danger validationMsg">
                  {{validation.message}}
                </div>
              </div>
            </div>

            <div class="col-lg-5 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
              <label> Percentage<span class="text-danger fs-5">*</span> </label>
            </div>
            <div class="col-lg-7 col-md-6 col-sm-12 col-12 ">
              <input type="number" value="" class="form-control my-2" placeholder="Enter Percentage "
                [(ngModel)]="viewModel.selectedGenericPayroll.percentage" minlength="1" maxlength="3" name="percentage"
                #percentage="ngModel" pattern="^(100(\.0{1,2})?|\d{0,2}(\.\d{1,2})?)%?$" required>
              <div *ngFor="let validation of viewModel.validations.percentage">
                <div *ngIf="(percentage.touched || viewModel.formSubmitted) && percentage.hasError(validation.type)"
                  class="text-danger validationMsg">
                  {{validation.message}}
                </div>
              </div>
            </div>

            <div class="col-lg-5 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
              <label> Description </label>
            </div>
            <div class="col-lg-7 col-md-6 col-sm-12 col-12 ">
              <textarea type="text" value="" class="form-control my-2" placeholder="Enter Salary Description"
                [(ngModel)]="viewModel.selectedGenericPayroll.description" minlength="3" maxlength="50"
                name="description" #description="ngModel" pattern="^[A-Za-z][A-Za-z0-9\s]*$"></textarea>
              <div *ngFor="let validation of viewModel.validations.description">
                <div *ngIf="(description.touched || viewModel.formSubmitted) && description.hasError(validation.type)"
                  class="text-danger validationMsg">
                  {{validation.message}}
                </div>
              </div>
            </div>
            <div class="col-lg-5 col-md-6 col-sm-12 col-12 p-lg-2 p-md-2 p-sm-2 p-2">
              <label> Period Type<span class="text-danger fs-5">*</span> </label>
            </div>
            <div class="col-lg-7 col-md-6 col-sm-12 col-12 ">
              <select class="form-select p-2" aria-label="Default select example"
                [(ngModel)]="viewModel.selectedGenericPayroll.componentPeriodType" name="componentPeriodType"
                #componentPeriodType="ngModel" required>
                <option value="undefined" disabled selected>Select Period Type</option>
                <option selected *ngFor="let item of viewModel.componentPeriodTypeList" value="{{item}}"> {{item}}
                </option>
              </select>
              <div *ngFor="let validation of viewModel.validations.componentPeriodType">
                <div
                  *ngIf="(componentPeriodType.touched || viewModel.formSubmitted) && componentPeriodType.hasError(validation.type)"
                  class="text-danger validationMsg">
                  {{validation.message}}
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <div *ngIf="viewModel.selectedGenericPayroll.id==0">
              <button class="btn coinButton " (click)="addGenericPayrollComponent(payrollForm)"
                *ngIf="viewModel.Permission?.add">
                Add Component
              </button>
            </div>
            <div *ngIf="viewModel.showButton">
              <button class="btn coinButton" (click)="updateGenericPayrollComponent(payrollForm)"
                *ngIf="viewModel.Permission?.edit"> Update Details </button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>